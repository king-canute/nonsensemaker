---
// src/pages/index.astro
import HomepageLayout from '../layouts/HomepageLayout.astro';

// Use the modern import.meta.glob to fetch articles
const posts = import.meta.glob('../content/articles/*.md', { eager: true });
---
<HomepageLayout>
  <section>
    <h2>Latest Articles</h2>
    <ul class="article-list">
      {Object.entries(posts).map(([path, post]) => {
        // Derive the slug from the filename
        const slug = path.split('/').pop().replace('.md', '');
        return (
          <li>
            <h3>
              <a href={`/posts/${slug}/`}>{post.frontmatter.title}</a>
            </h3>
            <p>{post.frontmatter.description}</p>
          </li>
        )
      })}
    </ul>
  </section>
</HomepageLayout>

<style>
  .article-list {
    list-style: none;
    padding: 0;
  }
  .article-list li {
    padding-bottom: 1.5rem;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid var(--color-border);
  }
  .article-list li:last-child {
    border-bottom: none;
  }
  .article-list h3 {
    margin-top: 0;
    font-size: 1.5rem;
  }
  .article-list h3 a {
    text-decoration: none;
  }
  .article-list h3 a:hover {
    text-decoration: underline;
  }
  .article-list p {
    margin-top: 0.5rem;
    margin-bottom: 0;
    color: #555;
  }
</style>